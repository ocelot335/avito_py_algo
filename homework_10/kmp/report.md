это классический алгоритм. чтобы понять его, можно начать без префикс функции.
Будем идти по строке s и находить максимальное k такое что, что k последних пройденныъ символов образуют строку, которая равна k-префиксу sub. Так если нам известно k с прошлого шага, то мы можем попробовать сравнить k+1 символы, если они равны, то понятно, что мы нашли новое k. Если нет, то мы можем уменьшать k до тех пор, пока последние k символов не будут k-префиксом sub. То есть мы либо увеличиваем k не больше len(s) раз, либо уменьшаем, но не больше раз чем увеличили. Префикс функция по-сути является оптимизацией, чтобы не уменьшать k на единицу каждый раз, а сразу прийти к следующему кандидату. То есть действий будет даже меньше, тогда понятно что алгоритм работает за O(len(s)), если ещё надо построить префикс функцию, то на это уйдёт O(len(sub)) и того O(len(s)+len(sub)) 